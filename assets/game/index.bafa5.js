window.__require=function e(t,a,n){function o(s,r){if(!a[s]){if(!t[s]){var p=s.split("/");if(p=p[p.length-1],!t[p]){var l="function"==typeof __require&&__require;if(!r&&l)return l(p,!0);if(i)return i(p,!0);throw new Error("Cannot find module '"+s+"'")}s=p}var c=a[s]={exports:{}};t[s][0].call(c.exports,function(e){return o(t[s][1][e]||e)},c,c.exports,e,t,a,n)}return a[s].exports}for(var i="function"==typeof __require&&__require,s=0;s<n.length;s++)o(n[s]);return o}({Arrow:[function(e,t){"use strict";cc._RF.push(t,"fd1a1Nq0XxKi5zBNSFfxCJc","Arrow");var a=t.exports,n=__extends,o=__decorate;Object.defineProperty(a,"__esModule",{value:!0});var i=cc._decorator,s=i.ccclass,r=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.start=function(){var e=cc.color(255,0,0),t=cc.color(255,255,255);cc.tween(this.node).to(.7,{color:e}).to(.7,{color:t}).union().repeatForever().start()},o([s],t)}(cc.Component));a.default=r,cc._RF.pop()},{}],Control:[function(e,t){"use strict";cc._RF.push(t,"625d5IJ/JBNaKBPtD1ZL0JH","Control");var a=e,n=t.exports,o=__extends,i=__decorate;Object.defineProperty(n,"__esModule",{value:!0});var s=a("GameDataCenter"),r=a("GameDefine"),p=cc._decorator,l=p.ccclass,c=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isClick=!0,t}return o(t,e),t.prototype.start=function(){var e=this;this.scheduleOnce(function(){e.isClick=!1},1)},t.prototype.onEnable=function(){cc.systemEvent.on(s.GameDataCenter.EEventName.GAMEWIN_REFRESH,this.reStart,this)},t.prototype.onDisable=function(){cc.systemEvent.off(s.GameDataCenter.EEventName.GAMEWIN_REFRESH,this.reStart,this)},t.prototype.reStart=function(){var e=this;this.scheduleOnce(function(){e.isClick=!1},1)},t.prototype.onClicked=function(e){var t=this;this.isClick||s.GameDataCenter.isDowning||(this.isClick=!0,this.scheduleOnce(function(){t.isClick=!1},.3),cc.systemEvent.emit(r.EGameEvent.BTN_EVENT,e.target.name))},t.moveList=[],i([l],t)}(cc.Component));n.default=c,cc._RF.pop()},{}],GameFailWin:[function(e,t){"use strict";cc._RF.push(t,"669141OaxdM5KPoihN/E+xD","GameFailWin");var a=e,n=t.exports,o=__extends,i=__decorate;Object.defineProperty(n,"__esModule",{value:!0});var s=a("GameConst"),r=a("BasePanel"),p=a("Custom"),l=a("Core"),c=a("AudioManager"),d=a("GameDataCenter"),u=a("GameDefine"),m=a("WXTTUtils"),y=a("Analysis"),f=a("PowerManager"),h=cc._decorator,v=h.ccclass,E=h.property,C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.light=null,t.failNode=null,t}return o(t,e),t.prototype.onEnable=function(){y.Analysis.wxSendEvent("panel_exposure",{panel:"\u5931\u8d25\u9875"})},t.prototype.onDisable=function(){y.Analysis.wxSendEvent("panel_close",{panel:"\u5931\u8d25\u9875"})},t.prototype.start=function(){d.GameDataCenter.isGameWin=!1,c.default.playSound(u.ESoundName.FAIL),m.default.initInterstitialAd(),d.GameDataCenter.isShowTip=!1,this.failNode.scale=0,cc.tween(this.failNode).to(.5,{scale:1}).start(),cc.tween(this.light).by(1,{angle:-120}).repeatForever().start()},t.prototype.onClicked=function(e){switch(c.default.playSound(u.ESoundName.CLICK),p.default.GRIDAD4Show=!1,p.default.GRIDAD5Show=!1,p.default.hideGrid4(),p.default.hideGrid5(),cc.systemEvent.emit("IS_SHOW_BANNER",!1),e.target.name){case"btnRestart":if(y.Analysis.wxSendEvent("panel_interact",{panel:"\u5931\u8d25\u9875",value:"\u91cd\u73a9"}),!f.default.isStartGame())return l.Core.win.open(s.default.winPath.PowerWin2,null,!1);f.default.onPowerSub(),cc.systemEvent.emit(d.GameDataCenter.EEventName.GAMEWIN_REFRESH),this.close();break;case"btnBack":y.Analysis.wxSendEvent("panel_interact",{panel:"\u5931\u8d25\u9875",value:"\u8fd4\u56de\u9996\u9875"}),m.default.initInterstitialAd(),l.Core.win.open(s.default.winPath.GameStartWin,null,!0)}},i([E(cc.Node)],t.prototype,"light",void 0),i([E(cc.Node)],t.prototype,"failNode",void 0),i([v],t)}(r.default);n.default=C,cc._RF.pop()},{}],GameWinWin:[function(e,t){"use strict";cc._RF.push(t,"f9db2Jsfh9PXbCVNWW15FQ9","GameWinWin");var a=e,n=t.exports,o=__extends,i=__decorate;Object.defineProperty(n,"__esModule",{value:!0});var s=a("GameConst"),r=a("BasePanel"),p=a("Custom"),l=a("Core"),c=a("AudioManager"),d=a("GameDataCenter"),u=a("GameDefine"),m=a("WXTTUtils"),y=a("Analysis"),f=a("Store"),h=a("PowerManager"),v=cc._decorator,E=v.ccclass,C=v.property,D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.light=null,t.winNode=null,t}return o(t,e),t.prototype.start=function(){d.GameDataCenter.isGameWin=!1,f.Random.randomNumber(0,2)<1?c.default.playSound(u.ESoundName.VICTORY1):c.default.playSound(u.ESoundName.VICTORY2),m.default.initInterstitialAd(),d.GameDataCenter.isShowTip=!1,this.winNode.scale=0,cc.tween(this.winNode).to(.5,{scale:1}).start(),cc.tween(this.light).by(1,{angle:-120}).repeatForever().start()},t.prototype.onEnable=function(){y.Analysis.wxSendEvent("panel_exposure",{panel:"\u6210\u529f\u9875"})},t.prototype.onDisable=function(){y.Analysis.wxSendEvent("panel_close",{panel:"\u6210\u529f\u9875"})},t.prototype.onClicked=function(e){switch(c.default.playSound(u.ESoundName.CLICK),p.default.GRIDAD4Show=!1,p.default.GRIDAD5Show=!1,p.default.hideGrid4(),p.default.hideGrid5(),cc.systemEvent.emit("IS_SHOW_BANNER",!1),e.target.name){case"btnNext":if(y.Analysis.wxSendEvent("panel_interact",{panel:"\u6210\u529f\u9875",value:"\u4e0b\u4e00\u5173"}),!h.default.isStartGame())return l.Core.win.open(s.default.winPath.PowerWin2,null,!1);h.default.onPowerSub(),d.GameDataCenter.tongLevel=[d.GameDataCenter.gameLevel],d.GameDataCenter.gameLevel++,cc.systemEvent.emit(d.GameDataCenter.EEventName.GAMEWIN_REFRESH),this.close();break;case"btnBack":y.Analysis.wxSendEvent("panel_interact",{panel:"\u6210\u529f\u9875",value:"\u8fd4\u56de\u9996\u9875"}),m.default.initInterstitialAd(),l.Core.win.open(s.default.winPath.GameStartWin,null,!0)}},i([C(cc.Node)],t.prototype,"light",void 0),i([C(cc.Node)],t.prototype,"winNode",void 0),i([E],t)}(r.default);n.default=D,cc._RF.pop()},{}],GameWin:[function(e,t){"use strict";cc._RF.push(t,"2f21ey2d4VAtZJyHOiGHMsc","GameWin");var a=e,n=t.exports,o=__extends,i=__decorate;Object.defineProperty(n,"__esModule",{value:!0}),n.GameWin=void 0;var s=a("GameConst"),r=a("BasePanel"),p=a("Custom"),l=a("Core"),c=a("AudioManager"),d=a("GameDataCenter"),u=a("GameDefine"),m=a("WXTTUtils"),y=a("WXTTUtils"),f=a("Analysis"),h=a("DateTime"),v=a("Store"),E=a("Item"),C=a("PowerManager"),D=a("LoadMap"),M=cc._decorator,G=M.ccclass,P=M.property,N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.txt_level=null,t.mapNode=null,t.gameLayer=null,t.tipNode=null,t.tipVideo=null,t.uiNode=null,t.tipTitle=null,t.tipLabel=null,t.yindaoNode=null,t.powerNode=null,t.startTime=0,t.endTime=0,t}return o(t,e),t.prototype.start=function(){this.replay(),this.addPower()},t.prototype.addPower=function(){this.powerNode=l.Core.pool.get("powerNode"),this.powerNode.parent=this.node,this.powerNode.getComponent(cc.Widget).isAlignTop=!0,this.powerNode.getComponent(cc.Widget).isAlignLeft=!0,this.powerNode.getComponent(cc.Widget).top=15,this.powerNode.getComponent(cc.Widget).left=10},t.prototype.reMovePower=function(){l.Core.pool.recover("powerNode",this.powerNode)},t.prototype.onEnable=function(){p.default.GRIDAD2Show=!0,p.default.GRIDAD3Show=!0,p.default.showGrid2(),p.default.showGrid3(),m.default.visWidth>=667&&m.default.showBanner(),cc.systemEvent.on(d.GameDataCenter.EEventName.ADD_BODY,this.onAddBody,this),cc.systemEvent.on(d.GameDataCenter.EEventName.REMOVE_TILE,this.onRemoveTile,this),cc.systemEvent.on(d.GameDataCenter.EEventName.GAME_FAIL,this.onShowFail,this),cc.systemEvent.on(d.GameDataCenter.EEventName.GAME_WIN,this.onShowWin,this),cc.systemEvent.on(d.GameDataCenter.EEventName.GAMEWIN_REFRESH,this.reStart,this),cc.systemEvent.on(d.GameDataCenter.EEventName.HIDE_UINODE,this.onHideUINode,this),cc.systemEvent.on(d.GameDataCenter.EEventName.RECOVER_POWER,this.reMovePower,this),cc.systemEvent.on("GAME_OVER",this.gameOver,this),f.Analysis.wxSendEvent("panel_exposure",{panel:"\u6e38\u620f\u9875"})},t.prototype.onDisable=function(){cc.systemEvent.off(d.GameDataCenter.EEventName.ADD_BODY,this.onAddBody,this),cc.systemEvent.off(d.GameDataCenter.EEventName.REMOVE_TILE,this.onRemoveTile,this),cc.systemEvent.off(d.GameDataCenter.EEventName.GAME_FAIL,this.onShowFail,this),cc.systemEvent.off(d.GameDataCenter.EEventName.GAME_WIN,this.onShowWin,this),cc.systemEvent.off(d.GameDataCenter.EEventName.GAMEWIN_REFRESH,this.reStart,this),cc.systemEvent.off(d.GameDataCenter.EEventName.HIDE_UINODE,this.onHideUINode,this),cc.systemEvent.off(d.GameDataCenter.EEventName.RECOVER_POWER,this.reMovePower,this),cc.systemEvent.off("GAME_OVER",this.gameOver,this),f.Analysis.wxSendEvent("panel_close",{panel:"\u6e38\u620f\u9875"})},t.prototype.reStart=function(){this.gameLayer.removeAllChildren(),this.replay(),this.addPower(),this.uiNode.active=!0,p.default.GRIDAD2Show=!0,p.default.GRIDAD3Show=!0,p.default.showGrid2(),p.default.showGrid3(),m.default.visWidth>=667&&m.default.showBanner()},t.prototype.replay=function(){this.loadLevels()},t.prototype.loadLevels=function(){this.startTime=h.DateTime.getTimeStamp(),f.Analysis.wxSendEvent("level",{level:d.GameDataCenter.gameLevel}),cc.systemEvent.emit(d.GameDataCenter.EEventName.RESET_CAMERA),this.txt_level.string="Level"+d.GameDataCenter.gameLevel,D.MapInfo.playerCount=0,D.MapInfo.playersMapPos=[],d.GameDataCenter.gameFail=!1,d.GameDataCenter.gameWin=!1,d.GameDataCenter.isGameStart=!0,d.GameDataCenter.isTipEnd=!1,d.GameDataCenter.isDowning=!1,D.MapInfo.tips=[],d.GameDataCenter.tipIndex=0,D.MapInfo.rocks=[],d.GameDataCenter.isGameWin=!0,this.createMap()},t.prototype.createMap=function(){p.default.initGrid1();var e,t=d.GameDataCenter.mapData;this.tiles=[];var a=1,n=0,o=0;e=d.GameDataCenter.gameLevel>156?v.Random.randomNumber(0,155):d.GameDataCenter.gameLevel-1;for(var i=[],s=0;s<t[e].content.size.y+20;s++){this.tiles[s]=[],i[s]=[],o++;for(var r=0;r<t[e].content.size.x+20;r++){var c=56*r-616,u=260-52*s,m=10*--n+o,y={pos:cc.v2(c,u),zIndex:m};this.tiles[s][r]=y,i[s][r]=0}}for(var f=0,h=t[e].content.all;f<h.length;f++){var C=(y=h[f]).pos,M=y.type,G=C.y+1,P=C.x+1,N=this.tiles[G][P],I=y.special;if(3===M){var g=l.Core.pool.get("block");g.getComponent(E.default).setData(G,P),g.x=N.pos.x,g.y=N.pos.y,g.zIndex=N.zIndex,g.parent=this.mapNode,i[G][P]=4}if(4===M){var w=l.Core.pool.get("apple");w.getComponent(E.default).setData(G,P),w.x=N.pos.x,w.y=N.pos.y,w.zIndex=N.zIndex,w.parent=this.mapNode,i[G][P]=3}if(2===M&&((A=l.Core.pool.get("rock")).getComponent(E.default).setData(G,P),A.x=N.pos.x,A.y=N.pos.y,A.zIndex=N.zIndex,A.parent=this.gameLayer,i[G][P]=5,D.MapInfo.rocks.push(A)),6===M&&(i[G][P]=6),8===M&&((A=l.Core.pool.get("wheel")).getComponent(E.default).setData(G,P),A.x=N.pos.x,A.y=N.pos.y,A.zIndex=N.zIndex,A.parent=this.mapNode,i[G][P]=7),0===M){a++;var x=l.Core.pool.get("player2");x.x=N.pos.x,x.y=N.pos.y,x.zIndex=N.zIndex,x.parent=this.gameLayer,x.name="player"+a.toString(),i[G][P]=1,(_=D.MapInfo.getPropInfo()).type=M,_.mapPos=cc.v2(P,G),cc.systemEvent.emit(d.GameDataCenter.EEventName.PLAYER_INFO,_,x)}if(1===M){var _,S=l.Core.pool.get("player1");S.x=N.pos.x,S.y=N.pos.y,S.zIndex=N.zIndex,S.parent=this.gameLayer,i[G][P]=1,(_=D.MapInfo.getPropInfo()).type=M,_.mapPos=cc.v2(P,G),cc.systemEvent.emit(d.GameDataCenter.EEventName.PLAYER_INFO,_,S)}if(5===M&&!I){var T=l.Core.pool.get("end");T.getComponent(E.default).setData(G,P),T.x=N.pos.x,T.y=N.pos.y,T.zIndex=N.zIndex,T.parent=this.mapNode,i[G][P]=2}}for(s=0;s<t[e].content.size.y+2;s++)for(r=0;r<t[e].content.size.x+2;r++)if(6===i[s][r]){var A,R=i[s+1>t[e].content.size.y+1?s:s+1][r],L=i[s-1<0?s:s-1][r],b=i[s][r>t[e].content.size.x+1?r:r+1],O=i[s][r<0?r:r-1],W=0;if(4===R?W=0:4===L?W=180:4===b?W=90:4===O&&(W=270),(A=l.Core.pool.get("trap")).getComponent(E.default).setData(s,r),A.x=this.tiles[s][r].pos.x,A.y=this.tiles[s][r].pos.y,A.angle=W,A.zIndex=this.tiles[s][r].zIndex,A.parent=this.mapNode,4!==R&&4!==L&&4!==b&&4!==O){cc.systemEvent.emit(d.GameDataCenter.EEventName.REMOVE_TILEC2,s,r);var F=l.Core.pool.get("thornBall");F.angle=W,F.x=this.tiles[s][r].pos.x,F.y=this.tiles[s][r].pos.y,F.zIndex=this.tiles[s][r].zIndex,F.parent=this.mapNode}}"yindao1"===t[e].content.extraImg?this.yindaoNode.spriteFrame=d.GameDataCenter.texture2D.yindao1:"yindao2"===t[e].content.extraImg&&(this.yindaoNode.spriteFrame=d.GameDataCenter.texture2D.yindao2),t[e].content.tip&&this.onShowTipLabel(t[e].content.tip);var B=d.GameDataCenter.guideData[e];D.MapInfo.maps=i,D.MapInfo.tips=B,d.GameDataCenter.isShowTip&&(this.tipVideo.active=!1,this.onShowTip())},t.prototype.nextLevel=function(){if(!C.default.isStartGame())return l.Core.win.open(s.default.winPath.PowerWin2,null,!1);C.default.onPowerSub(),d.GameDataCenter.tongLevel=[d.GameDataCenter.gameLevel],d.GameDataCenter.gameLevel++,this.close(),l.Core.win.open(s.default.winPath.GameWin,null,!0)},t.prototype.onClicked=function(e){switch(c.default.playSound(u.ESoundName.CLICK),e.target.name){case"btnHome":f.Analysis.wxSendEvent("panel_interact",{panel:"\u6e38\u620f\u9875",value:"\u8fd4\u56de\u9996\u9875"}),p.default.GRIDAD2Show=!1,p.default.GRIDAD3Show=!1,p.default.hideGrid2(),p.default.hideGrid3(),y.default.initInterstitialAd(),d.GameDataCenter.tipType="BACK",l.Core.win.open(s.default.winPath.TipWin,null,!1);break;case"btnLevel":f.Analysis.wxSendEvent("panel_interact",{panel:"\u6e38\u620f\u9875",value:"\u8fdb\u5165\u5173\u5361\u9875"}),p.default.GRIDAD2Show=!1,p.default.GRIDAD3Show=!1,p.default.hideGrid2(),p.default.hideGrid3(),y.default.initInterstitialAd(),l.Core.win.open(s.default.winPath.LevelWin,null,!1);break;case"btnRestart":f.Analysis.wxSendEvent("panel_interact",{panel:"\u6e38\u620f\u9875",value:"\u91cd\u5f00"}),d.GameDataCenter.tipType="RESTART",l.Core.win.open(s.default.winPath.TipWin,null,!1);break;case"btnTip":if(f.Analysis.wxSendEvent("panel_interact",{panel:"\u6e38\u620f\u9875",value:"\u70b9\u51fb\u63d0\u793a"}),cc.sys.isBrowser)return d.GameDataCenter.isShowTip=!0,this.reMovePower(),cc.systemEvent.emit(d.GameDataCenter.EEventName.REMOVE_TILEC),void cc.systemEvent.emit(d.GameDataCenter.EEventName.GAMEWIN_REFRESH);m.default.videoAdLoaded?m.default.wathVideo(function(e){c.default.wechatMiniGameShow(),0===e?(f.Analysis.wxSendEvent("ad",{value:"\u6e38\u620f\u9875\u70b9\u51fb\u63d0\u793a\u89c6\u9891\u64ad\u653e\u6210\u529f"}),d.GameDataCenter.isShowTip=!0,cc.systemEvent.emit(d.GameDataCenter.EEventName.REMOVE_TILEC),cc.systemEvent.emit(d.GameDataCenter.EEventName.GAMEWIN_REFRESH)):-2===e&&(f.Analysis.wxSendEvent("ad",{value:"\u6e38\u620f\u9875\u70b9\u51fb\u63d0\u793a\u89c6\u9891\u64ad\u653e\u5931\u8d25"}),m.default.share(function(e){e&&(d.GameDataCenter.isShowTip=!0,cc.systemEvent.emit(d.GameDataCenter.EEventName.REMOVE_TILEC),cc.systemEvent.emit(d.GameDataCenter.EEventName.GAMEWIN_REFRESH))}))}):(f.Analysis.wxSendEvent("ad",{value:"\u6e38\u620f\u9875\u70b9\u51fb\u63d0\u793a\u89c6\u9891\u64ad\u653e\u5931\u8d25"}),m.default.share(function(e){c.default.wechatMiniGameShow(),e&&(d.GameDataCenter.isShowTip=!0,cc.systemEvent.emit(d.GameDataCenter.EEventName.REMOVE_TILEC),cc.systemEvent.emit(d.GameDataCenter.EEventName.GAMEWIN_REFRESH))}))}},t.prototype.onAddBody=function(e,t){var a=l.Core.pool.get("player2");a.x=56*e-616,a.y=260-52*t,a.parent=this.gameLayer,a.name="player"+(D.MapInfo.playerCount+1).toString();var n=D.MapInfo.getPropInfo();n.type=1,n.mapPos=cc.v2(e,t),n.isAdd=!0,cc.systemEvent.emit(d.GameDataCenter.EEventName.PLAYER_INFO,n,a)},t.prototype.onRemoveTile=function(e,t){for(var a=56*e-616,n=260-52*t,o=0;o<this.mapNode.childrenCount;o++)this.mapNode.children[o].x===a&&this.mapNode.children[o].y===n&&l.Core.pool.recover(this.mapNode.children[o].name,this.mapNode.children[o])},t.prototype.onShowFail=function(){d.GameDataCenter.gameFail||(this.reMovePower(),cc.systemEvent.emit(d.GameDataCenter.EEventName.REMOVE_TILEC),this.onHideUINode(),cc.sys.isBrowser?l.Core.win.open(s.default.winPath.GameFailWin,null,!1):p.default.showGrid1())},t.prototype.onShowWin=function(){this.reMovePower(),cc.systemEvent.emit(d.GameDataCenter.EEventName.REMOVE_TILEC),this.onHideUINode(),cc.sys.isBrowser?l.Core.win.open(s.default.winPath.GameWinWin,null,!1):p.default.showGrid1()},t.prototype.gameOver=function(){p.default.GRIDAD4Show=!0,p.default.GRIDAD5Show=!0,p.default.showGrid4(),p.default.showGrid5(),cc.systemEvent.emit("IS_SHOW_BANNER",!0),y.default.initInterstitialAd(),this.endTime=h.DateTime.getTimeStamp(),f.Analysis.wxSendEvent("time",{time:this.endTime-this.startTime,level:d.GameDataCenter.gameLevel,result:d.GameDataCenter.gameFail}),d.GameDataCenter.gameFail?l.Core.win.open(s.default.winPath.GameFailWin,null,!1):l.Core.win.open(s.default.winPath.GameWinWin,null,!1)},t.prototype.onShowTip=function(){var e=cc.instantiate(this.tipNode);e.parent=this.gameLayer,e.x=0,e.y=0,d.GameDataCenter.tipNode=e,d.GameDataCenter.tipNode.zIndex=cc.macro.MAX_ZINDEX,cc.systemEvent.emit(d.GameDataCenter.EEventName.SET_TIP_POS)},t.prototype.onHideUINode=function(){this.uiNode.active=!1},t.prototype.onShowTipLabel=function(e){var t=this;this.tipTitle.zIndex=cc.macro.MAX_ZINDEX,this.tipTitle.scale=0,this.tipTitle.active=!0,this.tipLabel.string=e,cc.tween(this.tipTitle).to(.5,{scale:1}).delay(3).to(.5,{scale:0}).call(function(){t.tipTitle.active=!1}).start()},i([P(cc.Label)],t.prototype,"txt_level",void 0),i([P(cc.Node)],t.prototype,"mapNode",void 0),i([P(cc.Node)],t.prototype,"gameLayer",void 0),i([P(cc.Prefab)],t.prototype,"tipNode",void 0),i([P(cc.Node)],t.prototype,"tipVideo",void 0),i([P(cc.Node)],t.prototype,"uiNode",void 0),i([P(cc.Node)],t.prototype,"tipTitle",void 0),i([P(cc.Label)],t.prototype,"tipLabel",void 0),i([P(cc.Sprite)],t.prototype,"yindaoNode",void 0),i([G],t)}(r.default);n.GameWin=N,cc._RF.pop()},{}],LevelWin:[function(e,t){"use strict";cc._RF.push(t,"db9acluYLJM76eBaypuQl0Y","LevelWin");var a=e,n=t.exports,o=__extends,i=__decorate;Object.defineProperty(n,"__esModule",{value:!0});var s=a("BasePanel"),r=a("Custom"),p=a("AudioManager"),l=a("GameDataCenter"),c=a("GameDefine"),d=a("WXTTUtils"),u=a("Analysis"),m=cc._decorator,y=m.ccclass,f=m.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.levelLayer=null,t.levelNode=null,t.pageView=null,t.content=null,t.label=null,t.messageBox=null,t.pageCount=0,t}return o(t,e),t.prototype.start=function(){var e=10*Math.ceil(l.GameDataCenter.gameLevel/10)+10,t=l.GameDataCenter.tongLevel,a=0;this.pageCount=Math.ceil(e/10),this.label.string="1/"+this.pageCount;for(var n=!1,o=0,i=null;o<this.pageCount;o++){i=cc.instantiate(this.levelLayer),this.pageView.addPage(i),i.active=!0;for(var s=0;s<10;s++){a++;var r=cc.instantiate(this.levelNode),p=t.indexOf(a)<0;if(p&&(p=n,n=!0),r.parent=i,r.active=!0,r.emit(l.GameDataCenter.EEventName.LEVEL_INFO,{level:a,isLock:p}),a>=e)return}}},t.prototype.onEnable=function(){u.Analysis.wxSendEvent("panel_exposure",{panel:"\u5173\u5361\u9875"}),cc.systemEvent.on(l.GameDataCenter.EEventName.SHOW_MESSAGE,this.onShowMessage,this),cc.systemEvent.on(l.GameDataCenter.EEventName.CLOSE_LEVEL,this.closeLevel,this)},t.prototype.onDisable=function(){u.Analysis.wxSendEvent("panel_close",{panel:"\u5173\u5361\u9875"}),cc.systemEvent.off(l.GameDataCenter.EEventName.SHOW_MESSAGE,this.onShowMessage,this),cc.systemEvent.off(l.GameDataCenter.EEventName.CLOSE_LEVEL,this.closeLevel,this)},t.prototype.closeLevel=function(){this.close()},t.prototype.onClicked=function(e){if("btnLeft"==e.target.name)(t=this.pageView.getCurrentPageIndex())-1<0?t=0:(p.default.playSound(c.ESoundName.TURNPAGE),t--),this.pageView.scrollToPage(t,.5);else if("btnRight"==e.target.name){var t;(t=this.pageView.getCurrentPageIndex())+1>this.pageCount-1?t=this.pageCount-1:(p.default.playSound(c.ESoundName.TURNPAGE),t++),this.pageView.scrollToPage(t,.5)}else"btnClose"==e.target.name&&(p.default.playSound(c.ESoundName.CLICK),l.GameDataCenter.isGameWin?(r.default.GRIDAD2Show=!0,r.default.GRIDAD3Show=!0,r.default.showGrid2(),r.default.showGrid3()):(cc.systemEvent.emit("IS_SHOW_BANNER",!0),r.default.GRIDAD4Show=!0,r.default.GRIDAD5Show=!0,r.default.showGrid4(),r.default.showGrid5(),d.default.initInterstitialAd()),this.close())},t.prototype.onPageEvent=function(){p.default.playSound(c.ESoundName.TURNPAGE);var e=this.pageView.getCurrentPageIndex();this.label.string=e+1+"/"+this.pageCount},t.prototype.onShowMessage=function(){var e=cc.instantiate(this.messageBox);e.scale=0,e.parent=this.node,e.x=0,e.y=200,cc.tween(e).to(.5,{scale:1}).delay(2).to(.5,{scale:0}).call(function(){e.destroy()}).start()},i([f(cc.Node)],t.prototype,"levelLayer",void 0),i([f(cc.Prefab)],t.prototype,"levelNode",void 0),i([f(cc.PageView)],t.prototype,"pageView",void 0),i([f(cc.Node)],t.prototype,"content",void 0),i([f(cc.Label)],t.prototype,"label",void 0),i([f({type:cc.Prefab,tooltip:"\u4fe1\u606f\u6846"})],t.prototype,"messageBox",void 0),i([y],t)}(s.default);n.default=h,cc._RF.pop()},{}],Level:[function(e,t){"use strict";cc._RF.push(t,"9af90Hy/htPKabCk/e9zM5J","Level");var a=e,n=t.exports,o=__extends,i=__decorate;Object.defineProperty(n,"__esModule",{value:!0});var s=a("GameConst"),r=a("Core"),p=a("AudioManager"),l=a("GameDataCenter"),c=a("GameDefine"),d=a("PowerManager"),u=cc._decorator,m=u.ccclass,y=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lockNode=null,t.chooseNode=null,t.LevelNum=null,t.level=1,t.isLock=!1,t.info=null,t}return o(t,e),t.prototype.start=function(){this.LevelNum.string=""+this.level,this.lockNode.active=this.isLock,l.GameDataCenter.gameLevel===this.level?this.chooseNode.active=!0:this.chooseNode.active=!1},t.prototype.onEnable=function(){this.node.on(l.GameDataCenter.EEventName.LEVEL_INFO,this.onInfo,this)},t.prototype.onDisable=function(){this.node.destroy(),this.node.off(l.GameDataCenter.EEventName.LEVEL_INFO,this.onInfo,this)},t.prototype.onInfo=function(e){this.info=e,this.level=e.level||1,this.isLock=!!e.isLock},t.prototype.onClicked=function(){if(p.default.playSound(c.ESoundName.CLICK),l.GameDataCenter.isShowTip=!1,this.isLock)cc.systemEvent.emit(l.GameDataCenter.EEventName.SHOW_MESSAGE);else{if(!d.default.isStartGame())return r.Core.win.open(s.default.winPath.PowerWin2,null,!1);if(d.default.onPowerSub(),l.GameDataCenter.gameLevel=this.level,l.GameDataCenter.isGameStart)return cc.systemEvent.emit(l.GameDataCenter.EEventName.RECOVER_POWER),cc.systemEvent.emit(l.GameDataCenter.EEventName.REMOVE_TILEC),cc.systemEvent.emit(l.GameDataCenter.EEventName.GAMEWIN_REFRESH),void cc.systemEvent.emit(l.GameDataCenter.EEventName.CLOSE_LEVEL);r.Core.win.open(s.default.winPath.GameWin,null,!0)}},i([y({type:cc.Node,tooltip:"\u5173\u5361\u89e3\u9501\u5c42"})],t.prototype,"lockNode",void 0),i([y({type:cc.Node,tooltip:"\u5173\u5361\u9009\u4e2d\u5c42"})],t.prototype,"chooseNode",void 0),i([y({type:cc.Label,tooltip:"\u5173\u5361\u6570\u5b57"})],t.prototype,"LevelNum",void 0),i([m],t)}(cc.Component);n.default=f,cc._RF.pop()},{}],LoadMap:[function(e,t){"use strict";cc._RF.push(t,"f8b5ebN1nZMIbG8pXJ2JNTT","LoadMap");var a=e,n=t.exports,o=__extends,i=__decorate;Object.defineProperty(n,"__esModule",{value:!0}),n.MapInfo=void 0;var s=a("GameDefine"),r=cc._decorator,p=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.block=null,t}return o(t,e),t.prototype.start=function(){},i([l(cc.Prefab)],t.prototype,"block",void 0),i([p],t)}(cc.Component);n.default=c;var d=function(){function e(){}return Object.defineProperty(e,"addPlayer",{set:function(t){e._playerCount++,t.count>=0&&(e._playersMapPos[t.count]=t.mapPos)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"playerCount",{get:function(){return e._playerCount},set:function(t){e._playerCount=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"playersMapPos",{get:function(){return e._playersMapPos},set:function(t){e._playersMapPos=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"addPlayerMapPos",{set:function(t){t.y=t.y<0?0:t.y,t.x=t.x<0?0:t.x,e._maps[t.y][t.x]=1,e.lastPlayerPos=cc.v2(e._playersMapPos[e._playerCount-1].x,e._playersMapPos[e._playerCount-1].y),e._maps[t.y][t.x]=1,e._maps[e._playersMapPos[e._playerCount-1].y][e._playersMapPos[e._playerCount-1].x]=0,e._playersMapPos.unshift(t),e._playersMapPos.pop()},enumerable:!1,configurable:!0}),e.setPlayerMapPos=function(t,a){e._playersMapPos[t]&&(e._playersMapPos[t]=a)},Object.defineProperty(e,"maps",{get:function(){return e._maps},set:function(t){e._maps=null,e._maps=t},enumerable:!1,configurable:!0}),e.getTypeByMapPos=function(t){return e._maps[t.y]&&e._maps[t.y][t.x]?e._maps[t.y][t.x]:s.MapConfig.null.type},e.judgeNextPos=function(t,a){var n=t,o=e.getTypeByMapPos(n),i=e.getMoveInfo();return i.isMove=parseInt(o)!=s.MapConfig.ground.type||parseInt(o)!=s.MapConfig.null.type||parseInt(o)!=s.MapConfig.player.type,i.isEnd=parseInt(o)==s.MapConfig.end.type||parseInt(o)==s.MapConfig.trap.type||parseInt(o)==s.MapConfig.obstacles.type,i.len=0,i.typeResult=parseInt(o),i.isAdd=parseInt(o)==s.MapConfig.apple.type,i.nextMapPos=n,i.dir=a,i},e.getPropInfo=function(){return{type:0,name:"",pos:cc.v2(),mapPos:cc.v2(),isAdd:!1}},e.getMoveInfo=function(){return{isMove:!1,len:0,typeResult:s.MapConfig.null.type,isEnd:!1,nextMapPos:void 0,dir:s.EBtnEvent.DOWN,isJump:!1,isAdd:!1}},e.getMapDir=function(e){var t=null;switch(e){case s.EBtnEvent.UP:t=cc.v2(0,-1);break;case s.EBtnEvent.DOWN:t=cc.v2(0,1);break;case s.EBtnEvent.LEFT:t=cc.v2(-1,0);break;case s.EBtnEvent.RIGHT:t=cc.v2(1,0)}return t},e.isPlayer=function(t,a){return void 0===a&&(a=!1),e.pointInArray(t,e.playersMapPos,a)},e.pointInArray=function(e,t,a){void 0===a&&(a=!1);for(var n=0;n<t.length;n++){var o=t[n];if(o.x==e.x&&o.y==e.y)return!a||n+1}return!!a&&0},e.isBesidePoint=function(e,t){return e.x-t.x==0&&1==Math.abs(e.y-t.y)||e.y-t.y==0&&1==Math.abs(e.x-t.x)},e.isPointTogether=function(t){for(var a=!0,n=0;n<t.length;n++)t[n],0!=n&&(e.isBesidePoint(t[n],t[n-1])||t[n].x==t[n-1].x&&t[n].y==t[n-1].y||(a=!1));return a},e.pointTemp=function(e){this.tempMapPos.push(e)},e.calibrationMapPos=function(){for(var e=[],t=0;t<this.tempMapPos.length;t++){var a=this.tempMapPos[t];this.pointInArray(a.nextMapPos,e)}},e._maps=null,e.tips=null,e.rocks=[],e._playersMapPos=[],e._playerCount=0,e.lastPlayerPos=cc.v2(0,0),e.tempMapPos=[],e}();n.MapInfo=d,cc._RF.pop()},{}],PlayerMgr:[function(e,t){"use strict";cc._RF.push(t,"32060THIVpNlZfMvzqAboZY","PlayerMgr");var a=e,n=t.exports,o=__extends,i=__decorate;Object.defineProperty(n,"__esModule",{value:!0});var s=a("Custom"),r=a("AudioManager"),p=a("GameDataCenter"),l=a("GameDefine"),c=a("WXTTUtils"),d=a("Store"),u=a("LoadMap"),m=cc._decorator,y=m.ccclass,f=m.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.moveObject=null,t.nextMapPos=null,t.moveEvent=null,t.playerNodes=[],t.playerMapPos=[],t.speedTime=.2,t.isDropFail=!1,t.skin=[],t.tipTitle=null,t.tipLabel=null,t}return o(t,e),t.prototype.onLoad=function(){var e=this;this.scheduleOnce(function(){e.updateSkin()})},t.prototype.onEnable=function(){cc.systemEvent.on(l.EGameEvent.BTN_EVENT,this.onBtnEvent,this),cc.systemEvent.on(p.GameDataCenter.EEventName.PLAYER_INFO,this.onInfo,this),cc.systemEvent.on(p.GameDataCenter.EEventName.SET_TIP_POS,this.setTipPos,this),cc.systemEvent.on(p.GameDataCenter.EEventName.GAMEWIN_REFRESH,this.reStart,this)},t.prototype.start=function(){},t.prototype.onDisable=function(){cc.systemEvent.off(l.EGameEvent.BTN_EVENT,this.onBtnEvent,this),cc.systemEvent.off(p.GameDataCenter.EEventName.PLAYER_INFO,this.onInfo,this),cc.systemEvent.off(p.GameDataCenter.EEventName.SET_TIP_POS,this.setTipPos,this),cc.systemEvent.off(p.GameDataCenter.EEventName.GAMEWIN_REFRESH,this.reStart,this)},t.prototype.reStart=function(){var e=this;this.scheduleOnce(function(){e.updateSkin()})},t.prototype.onBtnEvent=function(e){c.default.vibrateShort(),e!=l.EBtnEvent.UP&&e!=l.EBtnEvent.DOWN&&e!=l.EBtnEvent.LEFT&&e!=l.EBtnEvent.RIGHT||(e!=l.EBtnEvent.UP||p.GameDataCenter.isTipEnd?e!=l.EBtnEvent.DOWN||p.GameDataCenter.isTipEnd?e!=l.EBtnEvent.LEFT||p.GameDataCenter.isTipEnd?e!=l.EBtnEvent.RIGHT||p.GameDataCenter.isTipEnd||1!==u.MapInfo.tips[p.GameDataCenter.tipIndex]&&p.GameDataCenter.isShowTip&&(p.GameDataCenter.isTipEnd=!0,this.onShowTipLabel()):3!==u.MapInfo.tips[p.GameDataCenter.tipIndex]&&p.GameDataCenter.isShowTip&&(p.GameDataCenter.isTipEnd=!0,this.onShowTipLabel()):2!==u.MapInfo.tips[p.GameDataCenter.tipIndex]&&p.GameDataCenter.isShowTip&&(p.GameDataCenter.isTipEnd=!0,this.onShowTipLabel()):0!==u.MapInfo.tips[p.GameDataCenter.tipIndex]&&p.GameDataCenter.isShowTip&&(p.GameDataCenter.isTipEnd=!0,this.onShowTipLabel()),this.onControl(e))},t.prototype.onControl=function(e){var t=this;p.GameDataCenter.tipIndex++;var a=null,n=u.MapInfo.playersMapPos[0],o=this.getNextMapPos(e,n);if(5===(a=u.MapInfo.judgeNextPos(o,e)).typeResult){var i=o,s=this.getNextMapPos(e,i),c=u.MapInfo.judgeNextPos(s,e);if(c.typeResult===l.MapConfig.ground.type||c.typeResult===l.MapConfig.player.type)a.isMove=!1,r.default.playSound(l.ESoundName.NOTMOVE);else{r.default.playSound(l.ESoundName.PULLROCK),u.MapInfo.maps[s.y][s.x]=5,u.MapInfo.maps[o.y][o.x]=0;for(var d=this.posChange(o),m=this.posChange(s),y=0;y<u.MapInfo.rocks.length;y++)u.MapInfo.rocks[y].x==d.x&&u.MapInfo.rocks[y].y==d.y&&cc.tween(u.MapInfo.rocks[y]).to(this.speedTime,{x:m.x,y:m.y}).start();this.scheduleOnce(function(){t.judgeRockOnPlatform()},.3)}}this.nextMapPos=o,this.moveEvent=e,this.onMove(a)},t.prototype.onMove=function(e,t){var a=this;if(void 0===t&&(t=!1),this.moveObject=e,e.isMove&&e.typeResult!=l.MapConfig.ground.type&&e.typeResult!=l.MapConfig.player.type){if(e.isAdd&&(r.default.playSound(l.ESoundName.EATAPPLE),cc.systemEvent.emit(p.GameDataCenter.EEventName.REMOVE_TILE,this.nextMapPos.x,this.nextMapPos.y),cc.systemEvent.emit(p.GameDataCenter.EEventName.ADD_BODY,u.MapInfo.lastPlayerPos.x,u.MapInfo.lastPlayerPos.y)),this.moveNormal(),e.isEnd){if(e.typeResult===l.MapConfig.trap.type||e.typeResult===l.MapConfig.obstacles.type)return r.default.playSound(l.ESoundName.STAB),p.GameDataCenter.isShowTip&&this.onHideTip(),s.default.GRIDAD2Show=!1,s.default.GRIDAD3Show=!1,s.default.hideGrid2(),s.default.hideGrid3(),c.default.destroyBanner(),cc.systemEvent.emit(p.GameDataCenter.EEventName.GAME_FAIL),void(p.GameDataCenter.gameFail=!0);r.default.playSound(l.ESoundName.ENTERDOOR),p.GameDataCenter.gameWin=!0,p.GameDataCenter.isShowTip&&this.onHideTip(),cc.systemEvent.emit(p.GameDataCenter.EEventName.HIDE_UINODE),s.default.GRIDAD2Show=!1,s.default.GRIDAD3Show=!1,s.default.hideGrid2(),s.default.hideGrid3(),c.default.destroyBanner(),cc.systemEvent.emit(p.GameDataCenter.EEventName.MOVE_CAMERA),this.scheduleOnce(function(){a.onPlayMove(),a.scheduleOnce(function(){cc.systemEvent.emit(p.GameDataCenter.EEventName.GAME_WIN)},1.5)},1.5)}}else r.default.playSound(l.ESoundName.NOTMOVE)},t.prototype.moveNormal=function(){var e=this;r.default.playSound(l.ESoundName.MOVE),u.MapInfo.addPlayerMapPos=this.nextMapPos,this.moveObject;for(var t=u.MapInfo.playerCount,a=u.MapInfo.playersMapPos,n=0;n<t;n++){var o=this.playerNodes[n],i=a[n],s=this.posChange(i);cc.tween(o).to(this.speedTime,{x:s.x,y:s.y}).start(),0==n&&this.onChangeAngle(o)}this.scheduleOnce(function(){e.isDropFailSound(),e.judgePlayerOnPlatform(),e.updateSkin(),e.isRockDropFailSound(),e.scheduleOnce(function(){e.setTipPos(),e.judgeRockOnPlatform()},.2),e.moveObject=null},.2)},t.prototype.moveDown=function(){for(var e=u.MapInfo.playerCount,t=(u.MapInfo.playersMapPos,0),a=0;a<e;a++){var n=this.playerNodes[a],o=cc.v2(u.MapInfo.playersMapPos[a].x,u.MapInfo.playersMapPos[a].y+1),i=this.posChange(o);u.MapInfo.maps[u.MapInfo.playersMapPos[a].y][u.MapInfo.playersMapPos[a].x]=0,u.MapInfo.maps[u.MapInfo.playersMapPos[a].y+1][u.MapInfo.playersMapPos[a].x]=1,u.MapInfo.playersMapPos[a].y>=12&&t++,cc.tween(n).to(this.speedTime/3,{x:i.x,y:i.y}).start(),u.MapInfo.setPlayerMapPos(a,o),0==a&&this.onChangeAngle(n)}if(t>=e)for(p.GameDataCenter.isShowTip&&this.onHideTip(),s.default.GRIDAD2Show=!1,s.default.GRIDAD3Show=!1,s.default.hideGrid2(),s.default.hideGrid3(),c.default.destroyBanner(),cc.systemEvent.emit(p.GameDataCenter.EEventName.GAME_FAIL),p.GameDataCenter.gameFail=!0,a=0;a<e;a++)n=this.playerNodes[a],cc.tween(n).to(this.speedTime,{y:-700}).start();else this.setTipPos(),this.changePlayerMapPosValue()},t.prototype.rockDown=function(e,t){for(var a=this,n=cc.v2(e,t),o=cc.v2(e,t+1),i=this.posChange(n),s=this.posChange(o),r=0;r<u.MapInfo.rocks.length;r++)u.MapInfo.rocks[r].x==i.x&&u.MapInfo.rocks[r].y==i.y&&cc.tween(u.MapInfo.rocks[r]).to(this.speedTime/3,{x:s.x,y:s.y}).call(function(){u.MapInfo.maps[o.y][o.x]=5,u.MapInfo.maps[n.y][n.x]=0,a.judgeRockOnPlatform()}).start()},t.prototype.posChange=function(e){var t=cc.v2();return t.x=56*e.x-616,t.y=260-52*e.y,t},t.prototype.getNextMapPos=function(e,t){var a=u.MapInfo.getMapDir(e);return cc.v2(t.x+a.x,t.y+a.y)},t.prototype.onInfo=function(e,t){var a=t.name.split("r");a[1]||(a[1]="-1");var n=parseInt(a[1])-1;this.playerNodes[n]=t,this.playerMapPos[n]=e.mapPos,u.MapInfo.addPlayer={mapPos:e.mapPos,count:n,isAdd:e.isAdd},e.isAdd||this.playerNodes[0]&&this.playerNodes[1]&&this.playerMapPos[0]&&this.playerMapPos[1]&&(this.playerMapPos[0].x==this.playerMapPos[1].x?this.playerMapPos[0].y>this.playerMapPos[1].y?(this.moveEvent=l.EBtnEvent.DOWN,this.onChangeAngle(this.playerNodes[0])):(this.moveEvent=l.EBtnEvent.UP,this.onChangeAngle(this.playerNodes[0])):this.playerMapPos[0].x>this.playerMapPos[1].x?(this.moveEvent=l.EBtnEvent.RIGHT,this.onChangeAngle(this.playerNodes[0])):(this.moveEvent=l.EBtnEvent.LEFT,this.onChangeAngle(this.playerNodes[0])),this.moveEvent=null)},t.prototype.onChangeAngle=function(e){cc.isValid(e)&&e&&e.isValid&&(this.moveEvent==l.EBtnEvent.UP?e.angle=90:this.moveEvent==l.EBtnEvent.DOWN?e.angle=-90:this.moveEvent==l.EBtnEvent.LEFT?e.angle=180:this.moveEvent==l.EBtnEvent.RIGHT&&(e.angle=0))},t.prototype.isDropFailSound=function(){if(!p.GameDataCenter.gameFail&&!p.GameDataCenter.gameWin){for(var e=0,t=!1,a=1;a<10;a++){for(var n=0,o=0;o<u.MapInfo.playersMapPos.length;o++)0!==u.MapInfo.maps[u.MapInfo.playersMapPos[o].y+a][u.MapInfo.playersMapPos[o].x]&&1!==u.MapInfo.maps[u.MapInfo.playersMapPos[o].y+a][u.MapInfo.playersMapPos[o].x]&&6!==u.MapInfo.maps[u.MapInfo.playersMapPos[o].y+a][u.MapInfo.playersMapPos[o].x]&&7!==u.MapInfo.maps[u.MapInfo.playersMapPos[o].y+a][u.MapInfo.playersMapPos[o].x]||n++;1===a&&n===u.MapInfo.playersMapPos.length&&(t=!0),n===u.MapInfo.playersMapPos.length&&e++}9===e?r.default.playSound(l.ESoundName.DROPFAIL):t&&r.default.playSound(l.ESoundName.DROPGROUND)}},t.prototype.isRockDropFailSound=function(){if(!p.GameDataCenter.gameFail&&!p.GameDataCenter.gameWin)for(var e=0;e<20;e++)for(var t=0;t<30;t++)if(5===u.MapInfo.maps[e][t]){for(var a=!1,n=0,o=1;o<10;o++)0!==u.MapInfo.maps[e+o][t]&&6!==u.MapInfo.maps[e+o][t]||(1===o&&(a=!0),n++);9===n?(r.default.playSound(l.ESoundName.ROCKSCRAPBEFORE),this.scheduleOnce(function(){r.default.playSound(l.ESoundName.ROCKSCRAP)},.5)):a&&r.default.playSound(l.ESoundName.ROCKDROP)}},t.prototype.judgePlayerOnPlatform=function(){var e=this;if(!p.GameDataCenter.gameFail&&!p.GameDataCenter.gameWin){for(var t=0,a=0;a<u.MapInfo.playersMapPos.length;a++)0!==u.MapInfo.maps[u.MapInfo.playersMapPos[a].y+1][u.MapInfo.playersMapPos[a].x]&&1!==u.MapInfo.maps[u.MapInfo.playersMapPos[a].y+1][u.MapInfo.playersMapPos[a].x]&&6!==u.MapInfo.maps[u.MapInfo.playersMapPos[a].y+1][u.MapInfo.playersMapPos[a].x]&&7!==u.MapInfo.maps[u.MapInfo.playersMapPos[a].y+1][u.MapInfo.playersMapPos[a].x]||t++;if(t===u.MapInfo.playersMapPos.length){for(a=0;a<u.MapInfo.playersMapPos.length;a++)6!==u.MapInfo.maps[u.MapInfo.playersMapPos[a].y+1][u.MapInfo.playersMapPos[a].x]&&7!==u.MapInfo.maps[u.MapInfo.playersMapPos[a].y+1][u.MapInfo.playersMapPos[a].x]||this.scheduleOnce(function(){p.GameDataCenter.isShowTip&&e.onHideTip(),s.default.GRIDAD2Show=!1,s.default.GRIDAD3Show=!1,s.default.hideGrid2(),s.default.hideGrid3(),c.default.destroyBanner(),cc.systemEvent.emit(p.GameDataCenter.EEventName.GAME_FAIL),p.GameDataCenter.gameFail=!0},.2);this.scheduleOnce(function(){p.GameDataCenter.isDowning=!0,e.moveDown(),e.judgePlayerOnPlatform()},this.speedTime/3)}else p.GameDataCenter.isDowning=!1}},t.prototype.judgeRockOnPlatform=function(){if(!p.GameDataCenter.gameFail&&!p.GameDataCenter.gameWin)for(var e=0;e<20;e++)for(var t=0;t<30;t++)5===u.MapInfo.maps[e][t]&&(0!==u.MapInfo.maps[e+1][t]&&6!==u.MapInfo.maps[e+1][t]||this.rockDown(t,e))},t.prototype.changePlayerMapPosValue=function(){for(var e=[],t=[],a=0;a<u.MapInfo.playerCount;a++)e[a]=cc.v2(u.MapInfo.playersMapPos[a].x,u.MapInfo.playersMapPos[a].y+1);for(a=0;a<u.MapInfo.playerCount;a++)for(var n=0;n<u.MapInfo.playerCount;n++)e[a].x===u.MapInfo.playersMapPos[n].x&&e[a].y===u.MapInfo.playersMapPos[n].y&&(t[t.length]=e[a]);for(a=0;a<t.length;a++)u.MapInfo.maps[t[a].y-1][t[a].x]=1},t.prototype.updateSkin=function(){for(var e=u.MapInfo.playerCount,t=u.MapInfo.playersMapPos,a=1;a<e;a++){if(a===e-1){var n=this.getPos(t[a-1],t[a]);return this.playerNodes[a].getComponent(cc.Sprite).spriteFrame=this.skin[2],void(n===l.Direction.DOWN?this.playerNodes[a].angle=270:n===l.Direction.LEFT?this.playerNodes[a].angle=0:n===l.Direction.RIGHT?this.playerNodes[a].angle=180:n===l.Direction.UP&&(this.playerNodes[a].angle=90))}var o=this.getPos(t[a-1],t[a]),i=this.getPos(t[a],t[a+1]),s=this.getPos(t[a-1],t[a+1]);s===l.Direction.DOWN||s===l.Direction.LEFT||s===l.Direction.UP||s===l.Direction.RIGHT?(this.playerNodes[a].getComponent(cc.Sprite).spriteFrame=this.skin[0],o===l.Direction.DOWN?this.playerNodes[a].angle=270:o===l.Direction.LEFT?this.playerNodes[a].angle=0:o===l.Direction.RIGHT?this.playerNodes[a].angle=180:o===l.Direction.UP&&(this.playerNodes[a].angle=90)):s===l.Direction.LEFTDOWN?o===l.Direction.LEFT&&i===l.Direction.DOWN?(this.playerNodes[a].angle=0,this.playerNodes[a].getComponent(cc.Sprite).spriteFrame=this.skin[3]):o===l.Direction.DOWN&&i===l.Direction.LEFT&&(this.playerNodes[a].getComponent(cc.Sprite).spriteFrame=this.skin[1],this.playerNodes[a].angle=270):s===l.Direction.LEFTUP?o===l.Direction.LEFT&&i===l.Direction.UP?(this.playerNodes[a].getComponent(cc.Sprite).spriteFrame=this.skin[1],this.playerNodes[a].angle=0):o===l.Direction.UP&&i===l.Direction.LEFT&&(this.playerNodes[a].getComponent(cc.Sprite).spriteFrame=this.skin[3],this.playerNodes[a].angle=90):s===l.Direction.RIGHTDOWN?o===l.Direction.RIGHT&&i===l.Direction.DOWN?(this.playerNodes[a].getComponent(cc.Sprite).spriteFrame=this.skin[1],this.playerNodes[a].angle=180):o===l.Direction.DOWN&&i===l.Direction.RIGHT&&(this.playerNodes[a].getComponent(cc.Sprite).spriteFrame=this.skin[3],this.playerNodes[a].angle=270):s===l.Direction.RIGHTUP&&(o===l.Direction.RIGHT&&i===l.Direction.UP?(this.playerNodes[a].getComponent(cc.Sprite).spriteFrame=this.skin[3],this.playerNodes[a].angle=180):o===l.Direction.UP&&i===l.Direction.RIGHT&&(this.playerNodes[a].getComponent(cc.Sprite).spriteFrame=this.skin[1],this.playerNodes[a].angle=90))}},t.prototype.getPos=function(e,t){return e.y<t.y&&e.x==t.x?l.Direction.UP:e.y<t.y&&e.x<t.x?l.Direction.RIGHTUP:e.y==t.y&&e.x<t.x?l.Direction.RIGHT:e.y>t.y&&e.x<t.x?l.Direction.RIGHTDOWN:e.y>t.y&&e.x==t.x?l.Direction.DOWN:e.y>t.y&&e.x>t.x?l.Direction.LEFTDOWN:e.y==t.y&&e.x>t.x?l.Direction.LEFT:e.y<t.y&&e.x>t.x?l.Direction.LEFTUP:void 0},t.prototype.setTipPos=function(){if(p.GameDataCenter.isShowTip)if(p.GameDataCenter.isTipEnd)this.onHideTip();else{var e=cc.v2(0,0),t=0;0===u.MapInfo.tips[p.GameDataCenter.tipIndex]?(e=cc.v2(u.MapInfo.playersMapPos[0].x,u.MapInfo.playersMapPos[0].y-1),t=0):1===u.MapInfo.tips[p.GameDataCenter.tipIndex]?(e=cc.v2(u.MapInfo.playersMapPos[0].x+1,u.MapInfo.playersMapPos[0].y),t=-90):2===u.MapInfo.tips[p.GameDataCenter.tipIndex]?(e=cc.v2(u.MapInfo.playersMapPos[0].x,u.MapInfo.playersMapPos[0].y+1),t=-180):3===u.MapInfo.tips[p.GameDataCenter.tipIndex]&&(t=-270,e=cc.v2(u.MapInfo.playersMapPos[0].x-1,u.MapInfo.playersMapPos[0].y));var a=this.posChange(e);p.GameDataCenter.tipNode.x=a.x,p.GameDataCenter.tipNode.y=a.y,p.GameDataCenter.tipNode.angle=t}},t.prototype.onHideTip=function(){p.GameDataCenter.tipNode.active=!1},t.prototype.onShowTipLabel=function(){var e=this;this.tipTitle.zIndex=cc.macro.MAX_ZINDEX,this.tipTitle.scale=0,this.tipTitle.active=!0;var t=d.Random.randomNumber(0,10);this.tipLabel.string=t<5?"So you just can't trust me, right?":"Ah, yes, yes, you're walking right!",cc.tween(this.tipTitle).to(.5,{scale:1}).delay(1).to(.5,{scale:0}).call(function(){e.tipTitle.active=!1}).start()},t.prototype.onPlayMove=function(){for(var e=this,t=u.MapInfo.playerCount,a=function(a){n.scheduleOnce(function(){e.moveEvent===l.EBtnEvent.DOWN?e.nextMapPos=cc.v2(e.nextMapPos.x,e.nextMapPos.y+1):e.moveEvent===l.EBtnEvent.UP?e.nextMapPos=cc.v2(e.nextMapPos.x,e.nextMapPos.y-1):e.moveEvent===l.EBtnEvent.RIGHT?e.nextMapPos=cc.v2(e.nextMapPos.x+1,e.nextMapPos.y):e.moveEvent===l.EBtnEvent.LEFT&&(e.nextMapPos=cc.v2(e.nextMapPos.x-1,e.nextMapPos.y)),u.MapInfo.addPlayerMapPos=e.nextMapPos;for(var n=u.MapInfo.playersMapPos,o=0;o<t;o++){var i=e.playerNodes[o],s=n[o],r=e.posChange(s);cc.tween(i).to(e.speedTime/2,{x:r.x,y:r.y}).start(),0==o&&e.onChangeAngle(i)}e.updateSkin(),e.playerNodes[a].active=!1},n.speedTime*a/2)},n=this,o=0;o<t;o++)a(o)},i([f(cc.SpriteFrame)],t.prototype,"skin",void 0),i([f(cc.Node)],t.prototype,"tipTitle",void 0),i([f(cc.Label)],t.prototype,"tipLabel",void 0),i([y],t)}(cc.Component);n.default=h,cc._RF.pop()},{}],PowerWin2:[function(e,t){"use strict";cc._RF.push(t,"fa271fUYvVGEbehG8eHA6MO","PowerWin2");var a=e,n=t.exports,o=__extends,i=__decorate;Object.defineProperty(n,"__esModule",{value:!0});var s=a("BasePanel"),r=a("AudioManager"),p=a("GameDataCenter"),l=a("GameDefine"),c=a("WXTTUtils"),d=a("WXTTUtils"),u=a("Analysis"),m=cc._decorator,y=m.ccclass,f=m.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.powerBox=null,t}return o(t,e),t.prototype.start=function(){this.powerBox.scale=0,cc.tween(this.powerBox).to(.1,{scale:.6,y:220}).to(.15,{scale:1,y:0}).start()},t.prototype.onEnable=function(){u.Analysis.wxSendEvent("panel_exposure",{panel:"\u4f53\u529b\u98752"})},t.prototype.onDisable=function(){u.Analysis.wxSendEvent("panel_close",{panel:"\u4f53\u529b\u98752"})},t.prototype.onClicked=function(e){var t=this;switch(r.default.playSound(l.ESoundName.CLICK),e.target.name){case"btnClose":u.Analysis.wxSendEvent("panel_interact",{panel:"\u4f53\u529b\u98752",value:"\u6682\u4e0d\u6b23\u8d4f"}),p.GameDataCenter.isHomeWin,cc.tween(this.powerBox).to(.15,{scale:.6,y:220}).to(.1,{scale:0,y:50}).start(),this.scheduleOnce(function(){t.close()},.5);break;case"btnVideo":if(u.Analysis.wxSendEvent("panel_interact",{panel:"\u4f53\u529b\u98752",value:"\u5f00\u59cb\u6b23\u8d4f"}),cc.sys.isBrowser)return p.GameDataCenter.power+=20,cc.systemEvent.emit(p.GameDataCenter.EEventName.UPDATE_POWER),void this.close();if(c.default.videoAdLoaded){if(cc.sys.isBrowser)return p.GameDataCenter.isHomeWin,p.GameDataCenter.power+=20,cc.systemEvent.emit(p.GameDataCenter.EEventName.UPDATE_POWER),void this.close();r.default.wechatMiniGameShow(),c.default.wathVideo(function(e){0===e?(u.Analysis.wxSendEvent("ad",{value:"\u4f53\u529b\u98752\u589e\u52a0\u4f53\u529b\u89c6\u9891\u64ad\u653e\u6210\u529f"}),p.GameDataCenter.isHomeWin,p.GameDataCenter.power+=20,cc.systemEvent.emit(p.GameDataCenter.EEventName.UPDATE_POWER),t.close()):-2===e&&(u.Analysis.wxSendEvent("ad",{value:"\u4f53\u529b\u98752\u589e\u52a0\u4f53\u529b\u89c6\u9891\u64ad\u653e\u5931\u8d25"}),c.default.share(function(e){e&&(p.GameDataCenter.isHomeWin,p.GameDataCenter.power+=20,cc.systemEvent.emit(p.GameDataCenter.EEventName.UPDATE_POWER),t.close())}))})}else u.Analysis.wxSendEvent("ad",{value:"\u4f53\u529b\u98752\u589e\u52a0\u4f53\u529b\u89c6\u9891\u64ad\u653e\u5931\u8d25"}),d.default.share(function(e){r.default.wechatMiniGameShow(),e&&(p.GameDataCenter.isHomeWin,p.GameDataCenter.power+=20,cc.systemEvent.emit(p.GameDataCenter.EEventName.UPDATE_POWER),t.close())})}},i([f(cc.Node)],t.prototype,"powerBox",void 0),i([y],t)}(s.default);n.default=h,cc._RF.pop()},{}],PowerWin:[function(e,t){"use strict";cc._RF.push(t,"776d7JgoSlLabBc+5Pglro7","PowerWin");var a=e,n=t.exports,o=__extends,i=__decorate;Object.defineProperty(n,"__esModule",{value:!0});var s=a("GameConst"),r=a("BasePanel"),p=a("Core"),l=a("AudioManager"),c=a("GameDataCenter"),d=a("GameDefine"),u=a("WXTTUtils"),m=a("Analysis"),y=a("PowerManager"),f=cc._decorator,h=f.ccclass,v=f.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btnVideo=null,t.videoLabel=null,t.powerBox=null,t.videoCount=0,t}return o(t,e),t.prototype.start=function(){this.videoCount=0,this.videoLabel.string="("+this.videoCount+"/3)",this.powerBox.scale=0,cc.tween(this.powerBox).to(.1,{scale:.6,y:220}).to(.15,{scale:1,y:0}).start(),cc.tween(this.btnVideo).by(.3,{scale:.2}).by(.3,{scale:-.2}).union().repeatForever().start()},t.prototype.onEnable=function(){m.Analysis.wxSendEvent("panel_exposure",{panel:"\u4f53\u529b\u98751"})},t.prototype.onDisable=function(){m.Analysis.wxSendEvent("panel_close",{panel:"\u4f53\u529b\u98751"})},t.prototype.onClicked=function(e){var t=this;switch(l.default.playSound(d.ESoundName.CLICK),e.target.name){case"btnClose":cc.tween(this.powerBox).to(.15,{scale:.6,y:220}).to(.1,{scale:0,y:50}).start(),this.scheduleOnce(function(){t.close(),p.Core.win.open(s.default.winPath.PowerWin2,null,!1)},.5);break;case"btnVideo":if(cc.sys.isBrowser)return this.videoCount++,this.videoLabel.string="("+this.videoCount+"/3)",void(this.videoCount>=3&&(c.GameDataCenter.isHomeWin,y.default.setMaxPower(),cc.systemEvent.emit(c.GameDataCenter.EEventName.UPDATE_POWER),this.close()));u.default.videoAdLoaded?u.default.wathVideo(function(e){l.default.wechatMiniGameShow(),0===e?(m.Analysis.wxSendEvent("ad",{value:"\u4f53\u529b\u98751\u589e\u52a0\u4f53\u529b\u89c6\u9891\u64ad\u653e\u6210\u529f"}),t.videoCount++,t.videoLabel.string="("+t.videoCount+"/3)",t.videoCount>=3&&(c.GameDataCenter.isHomeWin,y.default.setMaxPower(),cc.systemEvent.emit(c.GameDataCenter.EEventName.UPDATE_POWER),t.close())):-2===e&&(m.Analysis.wxSendEvent("ad",{value:"\u4f53\u529b\u98751\u589e\u52a0\u4f53\u529b\u89c6\u9891\u64ad\u653e\u5931\u8d25"}),u.default.share(function(e){e&&(t.videoCount++,t.videoLabel.string="("+t.videoCount+"/3)",t.videoCount>=3&&(c.GameDataCenter.isHomeWin,y.default.setMaxPower(),cc.systemEvent.emit(c.GameDataCenter.EEventName.UPDATE_POWER),t.close()))}))}):(m.Analysis.wxSendEvent("ad",{value:"\u4f53\u529b\u98751\u589e\u52a0\u4f53\u529b\u89c6\u9891\u64ad\u653e\u5931\u8d25"}),u.default.share(function(e){l.default.wechatMiniGameShow(),e&&(t.videoCount++,t.videoLabel.string="("+t.videoCount+"/3)",t.videoCount>=3&&(c.GameDataCenter.isHomeWin,y.default.setMaxPower(),cc.systemEvent.emit(c.GameDataCenter.EEventName.UPDATE_POWER),t.close()))}))}},i([v(cc.Node)],t.prototype,"btnVideo",void 0),i([v(cc.Label)],t.prototype,"videoLabel",void 0),i([v(cc.Node)],t.prototype,"powerBox",void 0),i([h],t)}(r.default);n.default=E,cc._RF.pop()},{}],SkinManager:[function(e,t){"use strict";cc._RF.push(t,"efd4dEBwwtPvJwAzNjn8Ifp","SkinManager");var a=e,n=t.exports,o=__extends,i=__decorate;Object.defineProperty(n,"__esModule",{value:!0});var s=a("GameDataCenter"),r=cc._decorator,p=r.ccclass,l=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.skin=[],t}return o(t,e),t.prototype.start=function(){},t.prototype.onEnable=function(){cc.systemEvent.on(s.GameDataCenter.EEventName.UPDATE_SKIN,this.updateSkin,this)},t.prototype.onDisable=function(){cc.systemEvent.off(s.GameDataCenter.EEventName.UPDATE_SKIN,this.updateSkin,this)},t.prototype.updateSkin=function(){},i([l(cc.SpriteFrame)],t.prototype,"skin",void 0),i([p],t)}(cc.Component);n.default=c,cc._RF.pop()},{}],TipWin:[function(e,t){"use strict";cc._RF.push(t,"18d986utVNJZKN0ROrQhv/P","TipWin");var a=e,n=t.exports,o=__extends,i=__decorate;Object.defineProperty(n,"__esModule",{value:!0});var s=a("GameConst"),r=a("BasePanel"),p=a("Custom"),l=a("Core"),c=a("AudioManager"),d=a("GameDataCenter"),u=a("GameDefine"),m=a("Analysis"),y=a("PowerManager"),f=cc._decorator,h=f.ccclass,v=f.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tipBox=null,t.tip=null,t}return o(t,e),t.prototype.start=function(){this.tipInfo(),this.tipBox.scale=0,cc.tween(this.tipBox).to(.1,{scale:.6,y:220}).to(.15,{scale:1,y:0}).start()},t.prototype.onEnable=function(){m.Analysis.wxSendEvent("panel_exposure",{panel:"\u63d0\u793a\u9875"})},t.prototype.onDisable=function(){m.Analysis.wxSendEvent("panel_close",{panel:"\u63d0\u793a\u9875"})},t.prototype.onClicked=function(e){var t=this;switch(c.default.playSound(u.ESoundName.CLICK),e.target.name){case"btnClose":"BACK"===d.GameDataCenter.tipType&&(p.default.GRIDAD2Show=!0,p.default.GRIDAD3Show=!0,p.default.showGrid2(),p.default.showGrid3()),cc.tween(this.tipBox).to(.15,{scale:.6,y:220}).to(.1,{scale:0,y:50}).start(),this.scheduleOnce(function(){t.close()},.5);break;case"btnSure":if(cc.tween(this.tipBox).to(.15,{scale:.6,y:220}).to(.1,{scale:0,y:50}).start(),this.scheduleOnce(function(){t.close()},.5),"BACK"===d.GameDataCenter.tipType)l.Core.win.open(s.default.winPath.GameStartWin,null,!0);else{if(!y.default.isStartGame())return l.Core.win.open(s.default.winPath.PowerWin2,null,!1);y.default.onPowerSub(),cc.systemEvent.emit(d.GameDataCenter.EEventName.RECOVER_POWER),cc.systemEvent.emit(d.GameDataCenter.EEventName.REMOVE_TILEC),cc.systemEvent.emit(d.GameDataCenter.EEventName.GAMEWIN_REFRESH)}}},t.prototype.tipInfo=function(){"BACK"===d.GameDataCenter.tipType?this.tip.string="Must it be closed?":this.tip.string="Do you need to restart?"},i([v(cc.Node)],t.prototype,"tipBox",void 0),i([v(cc.Label)],t.prototype,"tip",void 0),i([h],t)}(r.default);n.default=E,cc._RF.pop()},{}]},{},["Arrow","Control","GameFailWin","GameWin","GameWinWin","Level","LevelWin","LoadMap","PlayerMgr","PowerWin","PowerWin2","SkinManager","TipWin"]);